#include "constants.hpp"

const UCHAR memory::CONSTANTS::WIN10::ExpAllocateHandleTableEntry_prologue_pattern[35] = 
{
			0x48, 0x89, 0x5C, 0x24, 0x10,  // mov qword ptr [rsp+10h],rbx
			0x48, 0x89, 0x6C, 0x24, 0x18,  // mov qword ptr [rsp+18h],rbp
			0x48, 0x89, 0x74, 0x24, 0x20,  // mov qword ptr [rsp+20h],rsi
			0x57,                // push rdi
			0x41, 0x54, 	  // push r12
			0x41, 0x55,          // push r13
			0x41, 0x56,          // push r14
			0x41, 0x57,          // push r15
			0x48, 0x83, 0xEC, 0x20, // sub rsp,20h
			0x0f, 0xb6, 0x41, 0x2c,  // movzx eax, byte ptr [rcx+2Ch]
			0x4c, 0x8b, 0xea
};

// KeServiceDescriptorTable = KiSystemServiceRepeat + read_uint32(KiSystemServiceRepeat + 3) + 7 
const UCHAR memory::CONSTANTS::WIN10::KiSystemServiceRepeat[21] =
{
	0x4c, 0x8d, 0x15, 0xCC, 0xCC, 0xCC, 0xCC, // mov r10, qword ptr [rip + 0xCCCCCCCC]
	0x4c, 0x8d, 0x1d, 0xCC, 0xCC, 0xCC, 0xCC, // mov r11, qword ptr [rip + 0xCCCCCCCC]
	0xf7, 0x43, 0x78, 0x80, 0x00, 0x00, 0x00, // test dword ptr [rbx+78h], 80h
};

